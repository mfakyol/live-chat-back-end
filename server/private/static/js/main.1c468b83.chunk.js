(this["webpackJsonplive-chat"]=this["webpackJsonplive-chat"]||[]).push([[0],{1:function(e,a,t){e.exports={emojis:"emojis_emojis__2r2co",recently:"emojis_recently__39Z9F",all:"emojis_all__OHWrN",emoji:"emojis_emoji__1w0Lp"}},101:function(e,a,t){e.exports={"spinner-wrapper":"style_spinner-wrapper__2DZ_b",spinner:"style_spinner__3N79A",mymove:"style_mymove__3FIib"}},14:function(e,a,t){e.exports={background:"sidebar_background__32xmP",sidebar:"sidebar_sidebar__1IdZz","sidebar-header":"sidebar_sidebar-header__2Hdsn",err:"sidebar_err__2coUY","toggle-bar":"sidebar_toggle-bar__3-AZC","connection-error":"sidebar_connection-error__1iqpB","filter-input":"sidebar_filter-input__ttHms",chats:"sidebar_chats__3BBvu",chat:"sidebar_chat__1mGAG",username:"sidebar_username__2i6xO",active:"sidebar_active__2UgRO","add-chat-container":"sidebar_add-chat-container__31mUV","search-user-input":"sidebar_search-user-input__2jBGI","search-user-button":"sidebar_search-user-button__1NtTr","search-result":"sidebar_search-result__2p_Df"}},16:function(e,a,t){e.exports={background:"my-profile_background__1viw3","profile-container":"my-profile_profile-container__TkJ0m",hr:"my-profile_hr__2uqeG","close-icon":"my-profile_close-icon__8gt0v","user-image-container":"my-profile_user-image-container__2gdC7","user-image":"my-profile_user-image__BTxQ5","info-container":"my-profile_info-container__2swHY",info:"my-profile_info__3yqnZ",fullname:"my-profile_fullname__2XoPT",edit:"my-profile_edit__2ruf5",description:"my-profile_description__3Xk0f"}},17:function(e,a,t){e.exports={background:"profile_background__20X5t","profile-container":"profile_profile-container__TjZHh","close-icon":"profile_close-icon__1OfjN","user-image-container":"profile_user-image-container__31XXh","user-image":"profile_user-image__2GRbw",hr:"profile_hr__ILviy","info-container":"profile_info-container__36QS7",info:"profile_info__1JmXJ",fullname:"profile_fullname__1m47i",description:"profile_description__33UJE"}},181:function(e,a,t){e.exports={"fetching-spinner-wrapper":"style_fetching-spinner-wrapper__DL8ZM",mymove:"style_mymove__1ME00"}},182:function(e,a,t){e.exports=t.p+"static/media/message-sound.34b40fda.ogg"},183:function(e,a,t){e.exports={"chat-home":"chat-home_chat-home__Nd0uN"}},187:function(e,a,t){e.exports=t(334)},192:function(e,a,t){},226:function(e,a){},228:function(e,a){},242:function(e,a){},244:function(e,a){},25:function(e,a,t){e.exports={"image-message":"image-message_image-message__1MCzH",title:"image-message_title__3luWD",images:"image-message_images__MHnE5","image-message-left":"image-message_image-message-left__2L0Md","image-message-right":"image-message_image-message-right__3w6Je","image-container":"image-message_image-container__O5bnJ",image:"image-message_image__ozEoD","small-image-container":"image-message_small-image-container__25K2F","small-image":"image-message_small-image__3lKj1",info:"image-message_info__307L0","seen-icon":"image-message_seen-icon__2MlGi",seenIcon:"image-message_seenIcon__2mt1h",time:"image-message_time__2nNEU"}},272:function(e,a){},274:function(e,a){},275:function(e,a){},281:function(e,a){},283:function(e,a){},301:function(e,a){},303:function(e,a){},31:function(e,a,t){e.exports={background:"image-container_background__1jQSH",container:"image-container_container__1Cj5x",images:"image-container_images__EQJT7","image-container":"image-container_image-container__a01A3","new-image-container":"image-container_new-image-container__2y7UI","delete-container":"image-container_delete-container__2U_z-","send-image-container":"image-container_send-image-container__2FZ_Z",title:"image-container_title__3ANlO","send-images-button":"image-container_send-images-button__skCf7"}},315:function(e,a){},318:function(e,a){},334:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),i=t(72),r=t.n(i),o=(t(192),t(30)),l=t(11),c=t(21),m=t.n(c),u=t(42),d=t(6),p=t(7),g=t(9),f=t(8),h=t(12),b=t(38),E=t.n(b),y=t(20),_=t(22),N=t(15),j=t(180),v=t.n(j),O=JSON.parse(localStorage.getItem("token")),S=v()("http://localhost:3001",{query:{token:O}});function I(e){return function(a){a({type:"PUSH_CHAT",payload:{data:e}})}}function k(e,a){return function(t){t({type:"UPDATE_CHAT_LAST_DATE",payload:{chatId:e,date:a}})}}function C(e){return e.sort((function(e,a){return e.lastDate>a.lastDate?-1:e.lastDate<a.lastDate?1:0}))}function D(){return function(e){S.emit("getChats",(function(a,t){var n;e((C(n=t),{type:"UPDATE_CHATS",payload:{data:C(n)}})),e({type:"UPDATE_IS_CHAT_LOADING",payload:{status:!1}})}))}}function w(e){return{type:"PUSH_IMAGES",payload:{data:e}}}function M(e){return{type:"UPDATE_MESSAGES_IS_LOAD\u0130NG",payload:{status:e}}}function A(e){return{type:"UPDATE_IS_FETCHING_MORE",payload:{status:e}}}function U(e){return{type:"PUSH_MESSAGE",payload:{data:e}}}var T=t(1),P=t.n(T),x=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(e){var n;return Object(d.a)(this,t),(n=a.call(this,e)).state={recently:Object.keys(e.recently).sort((function(a,t){return new Date(e.recently[t])-new Date(e.recently[a])}))},n}return Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var a=this;e.isOpen===this.props.isOpen||this.props.isOpen||this.setState({recently:Object.keys(this.props.recently).sort((function(e,t){return new Date(a.props.recently[t])-new Date(a.props.recently[e])}))})}},{key:"onClickHandle",value:function(e){"span"===e.target.localName&&this.props.onClickHandle(e.target.innerText)}},{key:"render",value:function(){var e=this.props.isOpen,a=this.state.recently;return console.log(),s.a.createElement("div",{onClick:this.onClickHandle.bind(this),style:{display:e?"block":"none"},className:P.a.emojis},s.a.createElement("div",{className:P.a.recently},s.a.createElement("p",null,"Recenly used"),a.map((function(e){return s.a.createElement("span",{key:e,className:P.a.emoji,role:"img","aria-labelledby":"emoji"},e)}))),s.a.createElement("div",{className:P.a.all},s.a.createElement("p",null,"All"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude00"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude03"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude04"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude01"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude06"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude05"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd23"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude02"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude42"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude43"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude09"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude0a"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude07"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd70"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude0d"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd29"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude18"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude17"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude1a"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude19"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude0b"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude1b"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude1c"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd2a"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude1d"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd11"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd17"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd2b"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd14"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd10"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd28"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude10"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude11"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude36"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude0f"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude12"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude44"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude2c"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd25"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude0c"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude14"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude2a"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd24"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude34"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude37"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd12"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd15"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd22"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd2e"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd27"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd75"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd76"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd74"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude35"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd2f"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd20"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd73"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude0e"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd13"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\uddd0"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude15"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude1f"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude41"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude2e"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude2f"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude32"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude33"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd7a"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude26"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude27"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude28"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude30"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude25"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude22"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude2d"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude31"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude16"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude23"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude1e"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude13"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude29"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude2b"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd71"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude24"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude21"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude20"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83e\udd2c"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\ude08"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\udc7f"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\ud83d\udc80"),s.a.createElement("span",{className:P.a.emoji,role:"img","aria-labelledby":"emoji"},"\u2620")))}}]),t}(n.Component),L=t(52),R=t.n(L),F=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){var e;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={emojisIsOpen:!1,content:"",recently:JSON.parse(localStorage.getItem("recently"))||{}},e}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",(function(){return localStorage.setItem("recently",JSON.stringify(e.state.recently))}))}},{key:"componentDidUpdate",value:function(e){e.chatId!==this.props.chatId&&this.setState({emojisIsOpen:!1,content:""})}},{key:"openFileDialog",value:function(){document.getElementById("imageInput").click()}},{key:"selectImages",value:function(e){var a=Array.from(e.target.files).map((function(e){return window.URL.createObjectURL(e)}));this.props.onPushImages(a),e.target.value=null}},{key:"onChangeHandle",value:function(e){this.setState(Object(_.a)({},e.target.name,e.target.value))}},{key:"toggleEmojiContainer",value:function(){this.setState({emojisIsOpen:!this.state.emojisIsOpen})}},{key:"addEmojiToMessage",value:function(e){this.setState({content:"".concat(this.state.content).concat(e)}),this.setState((function(a){return{recently:Object(y.a)(Object(y.a)({},a.recently),{},Object(_.a)({},e,Date.now()))}}))}},{key:"componentWillUnmount",value:function(){localStorage.setItem("recently",JSON.stringify(this.state.recently))}},{key:"sendMessage",value:function(e){var a=this.props,t=a.onPushMessage,n=a.onUpdateChatLastDate;this.setState({emojisIsOpen:!1,content:""});var s=this.state.content;if(""!==s.trim()){var i={chatId:this.props.chatId,message:{type:0,content:s}};S.emit("sendMessage",i,(function(e,a){e||(t(a),n(a.chatId,a.sentDate))})),document.querySelector("#content").focus()}}},{key:"render",value:function(){var e=this,a=this.state,t=a.content,n=a.recently;return s.a.createElement("div",{className:R.a["input-field"]},s.a.createElement("button",{onClick:this.openFileDialog.bind(this),className:R.a["image-button"]},s.a.createElement("i",{className:"far fa-image"})),s.a.createElement("input",{id:"imageInput",onChange:this.selectImages.bind(this),onFocus:function(){return e.props.scrollToBottom()},style:{display:"none"},type:"file",accept:"image/x-png,image/gif,image/jpeg",multiple:!0}),s.a.createElement("textarea",{id:"content",name:"content",value:t,onChange:this.onChangeHandle.bind(this),className:R.a.input,placeholder:"Text here",type:"text"}),s.a.createElement("button",{onClick:this.toggleEmojiContainer.bind(this),className:R.a["emoji-button"]},s.a.createElement("i",{className:"far fa-laugh"})),s.a.createElement(x,{recently:n,isOpen:this.state.emojisIsOpen,onClickHandle:this.addEmojiToMessage.bind(this)}),s.a.createElement("button",{onClick:this.sendMessage.bind(this),className:R.a["send-button"]},s.a.createElement("i",{className:"far fa-paper-plane"})))}}]),t}(n.Component),G=Object(h.b)(null,(function(e){return{onPushMessage:function(a){return e(U(a))},onPushImages:function(a){return e(w(a))},onUpdateChatLastDate:function(a,t){return e(k(a,t))}}}))(F),H=t(17),J=t.n(H),q="http://localhost:3001/api/v1",B=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){return Object(d.a)(this,t),a.apply(this,arguments)}return Object(p.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,a=e.toggleProfile,t=e.isOpen,n=e.user;return s.a.createElement("div",{style:{display:t?"block":"none"},className:J.a.background},s.a.createElement("div",{className:J.a["profile-container"]},s.a.createElement("span",{onClick:null,className:J.a["close-icon"]},s.a.createElement("i",{className:"fas fa-times",onClick:function(){return a()}})),s.a.createElement("div",{className:J.a["user-image-container"]},s.a.createElement("img",{className:J.a["user-image"],src:"".concat(q,"/profileimages/").concat(n.profileImage),alt:""})),s.a.createElement("hr",{className:J.a.hr}),s.a.createElement("div",{className:J.a["info-container"]},s.a.createElement("div",{className:J.a.info},s.a.createElement("i",{className:"fas fa-user"})),s.a.createElement("div",{className:J.a.fullname},n.fullName)),s.a.createElement("hr",{className:J.a.hr}),s.a.createElement("div",{className:J.a["info-container"]},s.a.createElement("div",{className:J.a.info},s.a.createElement("i",{className:"fas fa-pen"})),s.a.createElement("p",{className:J.a.description},n.description?n.description:"No context")),s.a.createElement("hr",{className:J.a.hr})))}}]),t}(n.Component),W=t(43),X=t.n(W),Y=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){var e;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={message:{}},e.delete=function(a,t){return t.preventDefault(),window.confirm(' Are you sure to delete "'.concat(a.content,'" message'))&&S.emit("deleteMessage",a._id,(function(a,t){if(t){var n=e.state.message;n.content="[message deleted]",t&&e.setState({message:n})}})),!1},e}return Object(p.a)(t,[{key:"render",value:function(){var e=this.props.isLeft,a=this.state.message;return s.a.createElement("div",{onContextMenu:e?null:this.delete.bind(this,a),className:"".concat(X.a.message," ").concat(e?X.a["message-left"]:X.a["message-right"])},s.a.createElement("span",{className:X.a.content},a.content,s.a.createElement("br",null),s.a.createElement("div",{className:X.a.info},s.a.createElement("span",{className:X.a.seenIcon},!e&&a.isSeen?s.a.createElement(s.a.Fragment,null," ",s.a.createElement("i",{className:"fas fa-eye"})," "):""),s.a.createElement("span",{className:X.a.time},new Date(Date.parse(a.sentDate)).toLocaleString().slice(11,16)))))}}],[{key:"getDerivedStateFromProps",value:function(e,a){return{message:e.message}}}]),t}(n.Component);var Z=t(31),Q=t.n(Z),K=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){var e;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={title:"",newImages:[]},e}return Object(p.a)(t,[{key:"onChangeHandle",value:function(e){this.setState(Object(_.a)({},e.target.name,e.target.value))}},{key:"close",value:function(e){"background"===e.target.id&&(e.target.style.display="none",this.props.onClearImages(),this.setState({title:""}))}},{key:"openNewImageInput",value:function(e){document.getElementById("addImageInput").click()}},{key:"addNewImages",value:function(e){var a=Array.from(e.target.files).map((function(e){return window.URL.createObjectURL(e)}));this.props.onPushImages(a)}},{key:"removeImage",value:function(e,a){this.props.onRemoveImage(e)}},{key:"sendImages",value:function(){var e=Object(u.a)(m.a.mark((function e(){var a,t,n,s,i,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.title,t=this.props,n=t.chatId,s=t.onPushMessage,i=t.onUpdateChatLastDate,r=[],e.next=5,Promise.all(this.props.images.map(function(){var e=Object(u.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(a).then((function(e){return e.blob()})).then((function(e){return r.push({image:e,type:e.type.replace("image/","")})})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()));case 5:S.emit("sendImageMessage",n,{title:a,images:r},(function(e,a){e||(s(a),i(n,a.sentDate))})),this.props.onClearImages(),this.setState({title:""});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,a=this.props.images,t=this.state.newImages;return s.a.createElement("div",{style:{display:a.length?"block":"none"},id:"background",onClick:this.close.bind(this),className:Q.a.background},s.a.createElement("div",{className:Q.a.container},s.a.createElement("div",{className:Q.a.images},a.map((function(a,t){return s.a.createElement("div",{id:t,key:t,className:Q.a["image-container"]},s.a.createElement("img",{src:a,alt:""}),s.a.createElement("div",{onClick:e.removeImage.bind(e,t),className:Q.a["delete-container"]},s.a.createElement("i",{className:"fas fa-trash-alt"})))})),s.a.createElement("div",{onClick:this.openNewImageInput.bind(this),className:Q.a["new-image-container"]},s.a.createElement("i",{className:"fas fa-plus"})),s.a.createElement("input",{style:{display:"none"},type:"file",value:t,onChange:this.addNewImages.bind(this),id:"addImageInput",accept:"image/x-png,image/gif,image/jpeg",multiple:!0})),s.a.createElement("div",{className:Q.a["send-image-container"]},s.a.createElement("input",{name:"title",value:this.state.title,onChange:this.onChangeHandle.bind(this),className:Q.a.title,autoFocus:!0,type:"text",placeholder:"Text here",autoComplete:"off"}),s.a.createElement("button",{onClick:this.sendImages.bind(this),className:Q.a["send-images-button"]},s.a.createElement("i",{className:"far fa-paper-plane"})))))}}]),t}(n.Component),V=Object(h.b)((function(e,a){return{images:e.images}}),(function(e){return{onClearImages:function(){return e({type:"CLEAR_IMAGES",payload:{}})},onRemoveImage:function(a){return e({type:"REMOVE_IMAGE",payload:{data:a}})},onPushImages:function(a){return e(w(a))},onPushMessage:function(a){return e(U(a))},onUpdateChatLastDate:function(a,t){return e(k(a,t))}}}))(K),z=t(25),$=t.n(z),ee=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){var e;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={message:{}},e.delete=function(a,t){return t.preventDefault(),window.confirm(' Are you sure to delete "'.concat(a.content.title,'" message'))&&S.emit("deleteMessage",a._id,(function(a,t){if(t){var n=e.state.message;n.content.title="[message deleted]",n.content.images=[],t&&e.setState({message:n})}})),!1},e}return Object(p.a)(t,[{key:"openImage",value:function(e){if("img"===e.target.localName)return console.log("dd"),void window.open(e.target.src,"_blank");window.open(e.target.children[0].src,"_blank")}},{key:"render",value:function(){var e=this,a=this.props,t=a.isLeft,n=a.message;return s.a.createElement("div",{onContextMenu:t?null:this.delete.bind(this,n),className:"".concat($.a["image-message"]," ").concat(t?$.a["image-message-left"]:$.a["image-message-right"])},s.a.createElement("div",{className:$.a.images},s.a.createElement("p",{className:$.a.title},n.content.title),n.content.images.length>1?n.content.images.map((function(a){return s.a.createElement("div",{onClick:e.openImage.bind(e),key:a,className:$.a["small-image-container"]},s.a.createElement("img",{className:$.a["small-image"],src:"".concat(q,"/messages/getimage/").concat(a,"?token=").concat(JSON.parse(localStorage.getItem("token"))),alt:""}))})):n.content.images.map((function(a){return s.a.createElement("div",{onClick:e.openImage.bind(e),key:a,className:$.a["image-container"]},s.a.createElement("img",{className:$.a.image,src:"".concat(q,"/messages/getimage/").concat(a,"?token=").concat(JSON.parse(localStorage.getItem("token"))),alt:""}))})),s.a.createElement("div",{className:$.a.info},s.a.createElement("span",{className:$.a.seenIcon},!t&&n.isSeen?s.a.createElement("i",{className:"fas fa-eye"}):""),s.a.createElement("span",{className:$.a.time},new Date(Date.parse(n.sentDate)).toLocaleString().slice(11,16)))))}}],[{key:"getDerivedStateFromProps",value:function(e,a){return{message:e.message}}}]),t}(n.Component),ae=t(101),te=t.n(ae);function ne(e){var a=e.status,t=Object(n.useRef)(null);return!a&&t.current?(t.current.style.opacity=0,setTimeout((function(){t.current&&(t.current.style.display="none")}),300)):t.current&&(t.current.style.opacity=1,setTimeout((function(){t.current&&(t.current.style.display="block")}),300)),s.a.createElement("div",{ref:t,className:te.a["spinner-wrapper"]},s.a.createElement("div",{className:te.a.spinner}))}var se=t(181),ie=t.n(se);var re=Object(h.b)((function(e,a){return{isFetchingMore:e.isFetchingMore}}),null)((function(e){return s.a.createElement("div",{style:{display:e.isFetchingMore?"block":"none"},className:ie.a["fetching-spinner-wrapper"]},s.a.createElement("i",{className:"fas fa-spinner fa-2x"}))})),oe=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(e){var n;return Object(d.a)(this,t),(n=a.call(this,e)).state={isOnline:!1,profileIsOpen:!1,isFetching:!1,canFetchMore:!0,oldScrollheight:0,chatId:""},n.scrollToBottom=function(){n.messagesEnd.scrollIntoView({})},n.messageboard=s.a.createRef(),n}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(m.a.mark((function e(){var a,t,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.messageboard.current.addEventListener("scroll",function(){var e=Object(u.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.target.scrollTop<=50&&!n.state.isFetching&&n.state.canFetchMore&&n.props.messages.length>0)){e.next=6;break}return e.next=3,n.setState({isFetching:!0,oldScrollheight:a.target.scrollHeight});case 3:return console.log(n.props.match.params.chatId),e.next=6,n.props.onGetOldMessages(n.props.match.params.chatId,n.props.messages[0].sentDate);case 6:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()),S.on("setSeen",(function(e,a){n.props.match.params.chatId===e&&n.props.onSetMessageSeen(a)})),a=this.props.match.params.chatId,t=function e(t){S.emit("setLastSeen",a,t,(function(a,t){a&&setTimeout((function(){e(Date.now())}),1e3)}))},e.next=6,this.props.onGetLastMessages(a);case 6:this.props.onResetUnread(a),t(Date.now()),S.on("isOnline",(function(e){n.setState({isOnline:e})})),S.emit("connectUserStatus",a,(function(e,a){n.setState({isOnline:a})}));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(e,a){return a.isFetching===this.state.isFetching&&a.canFetchMore===this.state.canFetchMore}},{key:"componentDidUpdate",value:function(){var e=Object(u.a)(m.a.mark((function e(a){var t,n,s=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.isFetching?(this.messageboard.current.scrollTop=this.messageboard.current.scrollHeight-this.state.oldScrollheight,a.messages.length+20>this.props.messages.length&&0!==a.messages.length&&this.setState({canFetchMore:!1}),this.setState({isFetching:!1})):this.scrollToBottom(),a.match.params.chatId===this.props.match.params.chatId){e.next=17;break}return e.next=4,this.props.onClearMessages();case 4:return e.next=6,this.props.onClearImages();case 6:return this.setState({profileIsOpen:!1}),this.setState({isFetching:!1,canFetchMore:!0}),S.emit("disConnectUserStatus",a.match.params.chatId),S.emit("connectUserStatus",this.props.match.params.chatId,(function(e,a){s.setState({isOnline:a})})),t=this.props.match.params.chatId,n=function e(a){S.emit("setLastSeen",t,a,(function(a,t){a&&setTimeout((function(){e(Date.now())}),1e3)}))},e.next=14,this.props.onGetLastMessages(t);case 14:this.setState({isFetching:!1}),this.props.onResetUnread(t),n(Date.now());case 17:case"end":return e.stop()}}),e,this)})));return function(a){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(u.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.onClearMessages();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleProfile",value:function(e){this.setState({profileIsOpen:!this.state.profileIsOpen})}},{key:"render",value:function(){var e=this,a=void 0,t=this.props.match.params.chatId,n=this.state,i=n.profileIsOpen,r=n.isOnline,l=this.props,c=l.chats,m=l.messages,u=l.isMessagesLoading,d=c.filter((function(e){return e._id===t}))[0];return s.a.createElement("main",{className:E.a.main},s.a.createElement("div",{ref:this.messageboard,className:E.a["message-board"]},s.a.createElement(ne,{status:u}),s.a.createElement("div",{className:E.a["message-board-header"]},d?s.a.createElement(s.a.Fragment,null,s.a.createElement("img",{src:"".concat(q,"/profileimages/").concat(d.user.profileImage),alt:""}),s.a.createElement("span",{onClick:this.toggleProfile.bind(this),className:E.a.username},d.user.fullName),s.a.createElement("span",{className:E.a.status},r?"Online":"Offline"),s.a.createElement(o.b,{to:"/chat"},s.a.createElement("i",{className:"fas fa-times"})),s.a.createElement(B,{isOpen:i,toggleProfile:this.toggleProfile.bind(this),user:d.user})):null),s.a.createElement("div",{id:"messageList",className:E.a.messages},s.a.createElement(re,null),m.length>0?s.a.createElement("div",{className:E.a["day-info"]},s.a.createElement("span",null,"".concat(new Date(m[0].sentDate).getDate(),"  ").concat(new Date(m[0].sentDate).toLocaleString("default",{month:"long"})))):null,m.map((function(e){var t=!1,n=!1;d&&(t=e.senderId===d.user._id);var i=new Date(e.sentDate);return a&&(a.getYear()===i.getYear()&&a.getMonth()===i.getMonth()&&a.getDay()===i.getDay()||(n=!0)),a=i,s.a.createElement(s.a.Fragment,{key:e._id},n?s.a.createElement("div",{className:E.a["day-info"]},s.a.createElement("span",null,i.getDate()+" "+i.toLocaleString("default",{month:"long"}))):"",0===e.type?s.a.createElement(Y,{message:e,isLeft:t}):1===e.type?s.a.createElement(ee,{message:e,isLeft:t}):null)})),s.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(a){e.messagesEnd=a}}))),s.a.createElement(V,{chatId:t}),s.a.createElement(G,{scrollToBottom:this.scrollToBottom.bind(this),chatId:t}))}}]),t}(n.Component),le=Object(h.b)((function(e,a){return{chats:e.chats,messages:e.messages,isMessagesLoading:e.isMessagesLoading}}),(function(e){return{onSetMessageSeen:function(a){return e((t=a,function(e){e({type:"SET_MESSAGE_SEEN",payload:{data:t}})}));var t},onClearMessages:function(){return e((function(e){e(A(!1)),e(M(!0)),e({type:"CLEAR_MESSAGES",payload:{}})}))},onClearImages:function(){return e({type:"CLEAR_IMAGES",payload:{}})},onResetUnread:function(a){return e(function(e){return{type:"RESET_UNREAD",payload:{chatId:e}}}(a))},onGetLastMessages:function(a){return e(function(e){return function(a){S.emit("getLastMessages",e,(function(e,t){e||(a({type:"SET_MESSAGES",payload:{data:t}}),a(M(!1)))}))}}(a))},onGetOldMessages:function(a,t){return e(function(e,a){return function(t){t(A(!0)),S.emit("getOldMessages",e,a,(function(e,a){e||(t({type:"SET_OLD_MESSAGES",payload:{messages:a}}),t(A(!1)))}))}}(a,t))}}}))(oe),ce=t(104),me=t.n(ce);function ue(e){return e.sort((function(e,a){return new Date(a.sentDate)-new Date(e.sentDate)}))}var de=t(182);function pe(e){return localStorage.setItem("sound",JSON.stringify(e)),{type:"UPDATE_SOUND",payload:{data:e}}}var ge=new Audio(t.n(de).a),fe=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){return Object(d.a)(this,t),a.apply(this,arguments)}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.match.params.path&&this.props.history.push("/chat");var a=JSON.parse(localStorage.getItem("token"));a&&me.a.decode(a)&&me.a.decode(a).apiKey||(localStorage.removeItem("token"),window.location.replace("/")),S.on("connect",(function(e){console.log(e),console.log("connected")})),S.on("connected",(function(){e.props.onGetSoundIsOpen(),e.props.ongetUser(),e.props.onGetChats(),e.props.onGetNotifications(),S.on("newMessage",(function(a){e.props.soundIsOpen&&(ge.pause(),ge.currentTime=0,ge.play());var t=e.props,n=t.onUpdateChatLastDate,s=t.onPushMessage,i=t.onPushUnred;a.chatId===e.props.match.params.path?(s(a),S.emit("setLastSeen",a.chatId,Date.now(),(function(e,a){}))):i(a.chatId),n(a.chatId,a.sentDate)})),S.on("forceQuit",(function(){localStorage.setItem("isForceQuit",JSON.stringify(!0)),localStorage.removeItem("token"),window.location.replace("/")}))}))}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,this.props.children)}}]),t}(n.Component),he=Object(h.b)((function(e){return{soundIsOpen:e.sound}}),(function(e){return{ongetUser:function(){return e((function(e){S.emit("getUserData",(function(a,t){t&&(console.log(t),e({type:"UPDATE_USER",payload:{data:t}}))}))}))},onGetChats:function(){return e(D())},onGetSoundIsOpen:function(){return e((function(e){var a=JSON.parse(localStorage.getItem("sound"));console.log(a),null===a&&(a=!0,localStorage.setItem("sound",JSON.stringify(!0))),e(pe(a))}))},onPushUnred:function(a){return e(function(e,a){return{type:"PUSH_UNREAD",payload:{chatId:e}}}(a))},onGetNotifications:function(){return e((function(e){S.emit("getNotifications",(function(a,t){a||e({type:"UPDATE_NOTIFICATIONS",payload:{data:t}})}))}))},onPushMessage:function(a){return e(U(a))},onUpdateChatLastDate:function(a,t){return e(k(a,t))}}}))(Object(l.f)(fe)),be=t(5),Ee=t.n(be),ye=t(16),_e=t.n(ye),Ne=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){var e;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={description:e.props.user.description?e.props.user.description.toString():"",isDescriptionEdit:!1,newImage:void 0},e}return Object(p.a)(t,[{key:"closeMyProfile",value:function(e){"background"===e.target.id&&this.props.toggleMyProfile()}},{key:"editDescription",value:function(e){this.setState({isDescriptionEdit:!0})}},{key:"saveDescription",value:function(e){var a=this;S.emit("changeDescription",this.state.description,(function(e,t){e||(a.setState({isDescriptionEdit:!1}),console.log(a.state.description))}))}},{key:"onChangeHandle",value:function(e){this.setState(Object(_.a)({},e.target.name,e.target.value))}},{key:"openFileDialog",value:function(e){document.querySelector("#image-input").click()}},{key:"onImageInputChange",value:function(e){var a=this;S.emit("changeProfileImage",{image:e.target.files[0],type:e.target.files[0].type.replace("image/","")},(function(e,t){e||(console.log(t),a.props.onUpdateProfileImage(t))}))}},{key:"render",value:function(){var e=this.props,a=e.toggleMyProfile,t=e.isOpen,n=e.user,i=this.state,r=i.description,o=i.isDescriptionEdit;return s.a.createElement("div",{id:"background",className:_e.a.background,style:{display:t?"block":"none"}},s.a.createElement("div",{className:_e.a["profile-container"]},s.a.createElement("span",{onClick:function(){return a()},className:_e.a["close-icon"]},s.a.createElement("i",{className:"fas fa-times"})),s.a.createElement("div",{onClick:this.openFileDialog.bind(this),className:_e.a["user-image-container"]},s.a.createElement("input",{onChange:this.onImageInputChange.bind(this),id:"image-input",style:{display:"none"},type:"file"}),s.a.createElement("img",{className:_e.a["user-image"],src:"".concat(q,"/profileimages/").concat(n.profileImage),alt:""})),s.a.createElement("hr",{className:_e.a.hr}),s.a.createElement("div",{className:_e.a["info-container"]},s.a.createElement("div",{className:_e.a.info},s.a.createElement("i",{className:"fas fa-user"})),s.a.createElement("div",{className:_e.a.fullname},n.fullName)),s.a.createElement("hr",{className:_e.a.hr}),s.a.createElement("div",{className:_e.a["info-container"]},s.a.createElement("div",{className:_e.a.info},s.a.createElement("i",{className:"fas fa-pen"})),s.a.createElement("p",{className:_e.a.description},s.a.createElement("span",{style:{display:o?"none":"block"}},r||"No context"),s.a.createElement("textarea",{value:r,onChange:this.onChangeHandle.bind(this),style:{display:o?"block":"none"},type:"text",name:"description",autoComplete:"off"})),s.a.createElement("div",{className:_e.a.edit},s.a.createElement("i",{style:{display:o?"none":"inline-block"},onClick:this.editDescription.bind(this),className:"far fa-edit"}),s.a.createElement("i",{onClick:this.saveDescription.bind(this),style:{display:o?"inline-block":"none"},className:"far fa-check-square"}))),s.a.createElement("hr",{className:_e.a.hr})))}}]),t}(n.Component),je=Object(h.b)(null,(function(e){return{onUpdateProfileImage:function(a){return e((t=a,function(e){e({type:"UPDATE_PROFILE_IMAGE",payload:{data:t}})}));var t}}}))(Ne),ve=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){var e;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={myProfile:!1,notificationsIsOpen:!1,accountMenuIsOpen:!1},e}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;S.on("newNotification",(function(a){e.props.onPushNotification(a)}))}},{key:"toggleAccountMenu",value:function(e){this.state.accountMenuIsOpen||this.setState({notificationsIsOpen:!1}),this.setState({accountMenuIsOpen:!this.state.accountMenuIsOpen})}},{key:"toggleNotification",value:function(){this.state.notificationsIsOpen||(this.props.onSetNotificationSeen(),S.emit("setNotificationLastSeen",Date.now()),this.setState({accountMenuIsOpen:!1})),this.setState({notificationsIsOpen:!this.state.notificationsIsOpen})}},{key:"answerRequest",value:function(e,a,t){var n=this;console.log(e,a),S.emit("answerRequest",e,a,(function(a,t){a||(t?(n.props.onPushChat(t),n.props.onRemoveNotification(e)):n.props.onRemoveNotification(e))}))}},{key:"copyUserId",value:function(e,a){var t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy",!1),t.remove()}},{key:"toggleSound",value:function(e){this.props.onUpdateSound(!this.props.sound)}},{key:"toggleMyProfile",value:function(e){this.setState({myProfile:!this.state.myProfile,accountMenuIsOpen:!1})}},{key:"logOut",value:function(e){S.disconnect(),localStorage.removeItem("token"),window.location.replace("/")}},{key:"render",value:function(){var e=this,a=this.props,t=a.user,n=a.notifications,i=a.sound,r=this.state,l=r.notificationsIsOpen,c=r.accountMenuIsOpen;return s.a.createElement("header",{className:Ee.a.header},s.a.createElement(o.b,{to:"/chat",className:Ee.a.brand},s.a.createElement("h1",null,"Live Chat ",s.a.createElement("span",null))),s.a.createElement("div",{className:Ee.a["notification-container"]},s.a.createElement("i",{onClick:this.toggleNotification.bind(this),className:"fas fa-bell"}),s.a.createElement("span",{style:{display:n.filter((function(e){return!e.isSeen})).length>0?"flex":"none"}},n.filter((function(e){return!e.isSeen})).length),s.a.createElement("div",{style:{display:l?"block":"none"},className:Ee.a["notification-list"]},s.a.createElement("h3",null,"Notifications"),s.a.createElement("hr",null),n.map((function(a){return 0===a.type?s.a.createElement("div",{key:a._id,className:Ee.a.notification},s.a.createElement("img",{src:"".concat(q,"/profileImages/").concat(a.sender.profileImage),alt:""}),s.a.createElement("span",null,s.a.createElement("b",null,a.sender.fullName)," sent friend request"),s.a.createElement("i",{onClick:e.answerRequest.bind(e,a._id,!0),className:"".concat(Ee.a.accept," fas fa-check")}),s.a.createElement("i",{onClick:e.answerRequest.bind(e,a._id,!1),className:"".concat(Ee.a.reject," fas fa-times")})):1===a.type?s.a.createElement("div",{key:a._id,className:Ee.a.notification},s.a.createElement("img",{src:"".concat(q,"/profileImages/").concat(a.reciever.profileImage),alt:""}),s.a.createElement("p",null,s.a.createElement("b",null,a.reciever.fullName)," ",a.answer?"accepted friend request.":"rejected friend request."),s.a.createElement("b",{className:Ee.a.time},new Date(a.sentDate).toLocaleDateString()),s.a.createElement("b",{className:Ee.a.date},new Date(a.sentDate).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))):null})))),t.profileImage?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:Ee.a.account},s.a.createElement("img",{onClick:this.toggleAccountMenu.bind(this),className:Ee.a["user-image"],src:"".concat(q,"/profileimages/").concat(t.profileImage),alt:""}),s.a.createElement("div",{style:{display:c?"block":"none"},id:"account-menu",className:Ee.a["account-menu"]},s.a.createElement("span",{className:Ee.a["account-info"]},s.a.createElement("img",{className:Ee.a["user-image"],src:"".concat(q,"/profileimages/").concat(t.profileImage),alt:""}),s.a.createElement("p",{className:Ee.a.username},t.fullName),s.a.createElement("p",{className:Ee.a.email},t.email),s.a.createElement("p",{className:Ee.a["user-id"],title:"click to copy"},"User Id:",s.a.createElement("span",{onClick:this.copyUserId.bind(this,t.shortId),title:"Click to copy"},"".concat(t.shortId))),s.a.createElement("hr",null),s.a.createElement("div",{className:Ee.a["sound-container"]},s.a.createElement("span",null," Message Sound: "),s.a.createElement("label",{className:Ee.a.switch},s.a.createElement("input",{onClick:this.toggleSound.bind(this),readOnly:!0,checked:i,type:"checkbox"}),s.a.createElement("span",{className:Ee.a.slider}))),s.a.createElement("div",{className:Ee.a["menu-items"]},s.a.createElement("span",{onClick:this.toggleMyProfile.bind(this),className:Ee.a["menu-item"]},"Profile"),s.a.createElement("span",{onClick:this.logOut.bind(this),className:Ee.a["menu-item"]},"Log Out"))))),s.a.createElement(je,{user:t,toggleMyProfile:this.toggleMyProfile.bind(this),isOpen:this.state.myProfile})):null)}}]),t}(n.Component),Oe=Object(h.b)((function(e,a){return{user:e.user,notifications:e.notifications,sound:e.sound}}),(function(e){return{onPushChat:function(a){return e(I(a))},onPushNotification:function(a){return e(function(e){return function(a){a({type:"PUSH_NOTIFICATION",payload:{data:e}})}}(a))},onRemoveNotification:function(a){return e(function(e){return function(a){a({type:"REMOVE_NOTIFICATION",payload:{data:e}})}}(a))},onSetNotificationSeen:function(){return e((function(e){e({type:"SET_NOTIFICATION_SEEN",payload:{}})}))},onUpdateSound:function(a){return e(pe(a))}}}))(Object(l.f)(ve)),Se=t(14),Ie=t.n(Se),ke=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){return Object(d.a)(this,t),a.apply(this,arguments)}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.chat;this.props.onGetUnreads(e._id,e.user._id)}},{key:"render",value:function(){var e=this,a=this.props,t=a.chat,n=a.unReads;return s.a.createElement(o.c,{onClick:function(){return e.props.closeSidebar()},className:Ie.a.chat,activeClassName:Ie.a.active,to:"/chat/".concat(t._id)},s.a.createElement("img",{src:"".concat(q,"/profileimages/").concat(t.user.profileImage),alt:""}),s.a.createElement("span",{className:Ie.a.username},t.user.fullName),s.a.createElement("i",{style:{display:n[t._id]?"block":"none"},className:"fas fa-comment"},s.a.createElement("span",null,n[t._id])))}}]),t}(n.Component),Ce=Object(h.b)((function(e,a){return{unReads:e.unReads}}),(function(e){return{onGetUnreads:function(a,t){return e(function(e,a){return function(t){S.emit("getUnreads",e,a,(function(a,n){t(function(e,a){return{type:"ADD_UNREAD",payload:{chatId:e,unRead:a}}}(e,n))}))}}(a,t))}}}))(ke),De=function(e){Object(g.a)(t,e);var a=Object(f.a)(t);function t(){var e;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=a.call.apply(a,[this].concat(s))).state={isMobile:!1,isOpen:!0,filter:"",isAddChatOpen:!1,searchInput:"",user:null,err:"",connectionStatus:!0},e}return Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.innerWidth<800&&this.setState({isMobile:!0}),window.addEventListener("resize",(function(a){window.innerWidth<800&&!e.state.isMobile?e.setState({isMobile:!0,isAddChatOpen:!1}):window.innerWidth>800&&e.state.isMobile&&e.setState({isMobile:!1})})),S.on("newChat",(function(a){e.props.onpushChat(a)})),S.on("connect",(function(){return e.setState({connectionStatus:!0})})),S.on("disconnect",(function(){return e.setState({connectionStatus:!1})}))}},{key:"closeSidebar",value:function(e){var a=document.querySelector("#sidebar");a.style.transform="translateX(-300px)",a.style.transform="translateX(-300px)",this.setState({isOpen:!1,isAddChatOpen:!1,searchInput:"",user:null})}},{key:"closeSidebarEvent",value:function(){this.setState({isOpen:!1,isAddChatOpen:!1,searchInput:"",user:null})}},{key:"toggleAddChat",value:function(e){return this.setState({isAddChatOpen:!this.state.isAddChatOpen,searchInput:"",user:null,err:""}),!1}},{key:"search",value:function(e){var a=this,t=this.state.searchInput;this.setState({err:"",user:null}),""!==t.trim()&&S.emit("searchUser",t,(function(e,t){e?a.setState({err:e}):a.setState({user:t})}))}},{key:"addUser",value:function(e,a){var t=this;console.log(e),S.emit("sendRequest",e,(function(e,a){e?t.setState({err:e}):(t.setState({user:Object(y.a)(Object(y.a)({},t.state.user),{},{status:a})}),console.log(a))}))}},{key:"onChangeHandle",value:function(e){this.setState(Object(_.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this,a=this.state,t=a.isMobile,n=a.isOpen,i=a.filter,r=a.isAddChatOpen,o=a.searchInput,l=a.user,c=a.err,m=a.connectionStatus,u=this.props,d=u.chats,p=u.isChatsLoading;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{style:{display:t&&n?"block":"none"},onClick:this.closeSidebar.bind(this),className:Ie.a.background}),s.a.createElement("span",{className:Ie.a["toggle-bar"]},s.a.createElement("i",{style:{display:t&&!n?"block":"none"},onClick:function(){return e.setState({isOpen:!0})},className:"fas fa-arrow-circle-right"})),s.a.createElement("div",{id:"sidebar",style:{transform:t&&n?"translate(0)":""},className:Ie.a.sidebar},s.a.createElement(ne,{status:p}),s.a.createElement("div",{className:Ie.a["sidebar-header"]},s.a.createElement("b",null,"CHATS"),s.a.createElement("span",{onClick:this.toggleAddChat.bind(this)},s.a.createElement("i",{className:"fas fa-plus"})," Add User"),s.a.createElement("i",{style:{display:t?"block":"none"},onClick:this.closeSidebar.bind(this),className:"fas fa-times"}),s.a.createElement("hr",null),s.a.createElement("div",{style:{display:m?"none":"block"},className:Ie.a["connection-error"]},s.a.createElement("i",{className:"fas fa-exclamation-circle"})," Connection lost. Trying to reconnect. Please check your network connection."),s.a.createElement("input",{className:Ie.a["filter-input"],type:"text",name:"filter",value:i,onChange:this.onChangeHandle.bind(this),placeholder:"filter by name"})),s.a.createElement("div",{className:Ie.a.chats},d.filter((function(e){return e.user.fullName.toLowerCase().includes(i.toLocaleLowerCase())})).map((function(a){return s.a.createElement(Ce,{closeSidebar:e.closeSidebarEvent.bind(e),key:a._id,chat:a})}))),s.a.createElement("div",{style:{display:r?"block":"none"},className:Ie.a["add-chat-container"]},s.a.createElement("input",{onChange:this.onChangeHandle.bind(this),className:Ie.a["search-user-input"],type:"text",name:"searchInput",value:o,placeholder:"user id"}),s.a.createElement("button",{onClick:this.search.bind(this),className:Ie.a["search-user-button"]},"Search"),s.a.createElement("hr",null),c?s.a.createElement("p",{className:Ie.a.err},c):"",l?s.a.createElement("div",{className:Ie.a["search-result"]},s.a.createElement("img",{src:"".concat(q,"/profileImages/").concat(l.profileImage),alt:""}),s.a.createElement("span",{title:l.fullName},l.fullName),l.status?s.a.createElement("i",{className:"fas fa-check"}):s.a.createElement("i",{onClick:this.addUser.bind(this,l._id),className:"fas fa-plus"})):""),s.a.createElement("div",{className:Ie.a["add-chat-background"]})))}}]),t}(n.Component),we=Object(h.b)((function(e,a){return{chats:e.chats,isChatsLoading:e.isChatsLoading}}),(function(e){return{onGetChats:function(){return e(D())},onpushChat:function(a){return e(I(a))}}}))(De),Me=t(183),Ae=t.n(Me);function Ue(){return s.a.createElement("div",{className:Ae.a["chat-home"]},s.a.createElement("h1",null,"Live Chat"),s.a.createElement("i",{className:"fas fa-comment"}))}var Te=function(){return s.a.createElement(o.a,null,s.a.createElement(l.c,null,s.a.createElement(l.a,{path:"/chat/:path?"},s.a.createElement(he,null,s.a.createElement(Oe,null),s.a.createElement(we,null),s.a.createElement(l.c,null,s.a.createElement(l.a,{path:"/chat/",exact:!0,render:Ue}),s.a.createElement(l.a,{path:"/chat/:chatId",exact:!0,component:le}))))))};var Pe=function(e){return s.a.createElement("div",{className:"App"},s.a.createElement(Te,null))},xe=t(41);var Le=Object(xe.combineReducers)({example:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"UPDATE_EXAMPLE":return a.payload.example;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"UPDATE_USER":return n.data;case"UPDATE_PROFILE_IMAGE":return Object(y.a)(Object(y.a)({},e),{},{profileImage:n.data});default:return e}},chats:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"UPDATE_CHATS":return n.data;case"PUSH_CHAT":return Object(N.a)(C([].concat(Object(N.a)(e),[n.data])));case"UPDATE_CHAT_LAST_DATE":return Object(N.a)(C(e.map((function(e){return e._id===n.chatId&&(e.lastDate=n.date),e}))));default:return e}},unReads:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,t=a.payload,n=a.type;switch(n){case"ADD_UNREAD":return Object(y.a)(Object(y.a)({},e),{},Object(_.a)({},t.chatId,t.unRead));case"PUSH_UNREAD":return e[t.chatId]+=1,Object(y.a)({},e);case"RESET_UNREAD":return e[t.chatId]=0,Object(y.a)({},e);default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,t=a.payload,n=a.type;switch(n){case"SET_MESSAGE_SEEN":var s=new Date(t.data);return e.map((function(e){return s>new Date(e.sentDate)&&(e.isSeen=!0),e}));case"SET_MESSAGES":return t.data;case"SET_OLD_MESSAGES":return[].concat(Object(N.a)(t.messages),Object(N.a)(e));case"PUSH_MESSAGE":return[].concat(Object(N.a)(e),[t.data]);case"CLEAR_MESSAGES":return[];default:return e}},images:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"PUSH_IMAGES":return[].concat(Object(N.a)(e),Object(N.a)(n.data));case"REMOVE_IMAGE":return Object(N.a)(e.filter((function(e,a){return a!==n.data})));case"CLEAR_IMAGES":return[];default:return e}},notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"UPDATE_NOTIFICATIONS":return ue(n.data);case"PUSH_NOTIFICATION":return Object(N.a)(ue([].concat(Object(N.a)(e),[n.data])));case"SET_NOTIFICATION_SEEN":var s=e.map((function(e){return e.isSeen=!0,e}));return Object(N.a)(ue(s));case"REMOVE_NOTIFICATION":var i=e.filter((function(e){return e._id!==n.data}));return Object(N.a)(ue(i));default:return e}},sound:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=arguments.length>1?arguments[1]:void 0,t=a.payload,n=a.type;switch(n){case"UPDATE_SOUND":return t.data;default:return e}},isMessagesLoading:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"UPDATE_MESSAGES_IS_LOAD\u0130NG":return n.status;default:return e}},isChatsLoading:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"UPDATE_IS_CHAT_LOADING":return n.status;default:return e}},isFetchingMore:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"UPDATE_IS_FETCHING_MORE":return n.status;default:return e}}}),Re=t(184),Fe=t(185),Ge=t(186),He=t.n(Ge),Je=Object(xe.createStore)(Le,Object(Re.composeWithDevTools)(Object(xe.applyMiddleware)(Fe.a,He.a)));r.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(h.a,{store:Je},s.a.createElement(Pe,null))),document.getElementById("root"))},38:function(e,a,t){e.exports={main:"message-board_main__D-7-S","message-board":"message-board_message-board__3YRFP","message-board-header":"message-board_message-board-header__3srOH",username:"message-board_username__32CKo",status:"message-board_status__3qE6w",messages:"message-board_messages__1q5TF","day-info":"message-board_day-info__-OYlv"}},43:function(e,a,t){e.exports={message:"text-message_message__3j-Ph","message-left":"text-message_message-left__2PEiY","message-right":"text-message_message-right__2npr6",info:"text-message_info__2lMKd",time:"text-message_time__3NA6N",seenIcon:"text-message_seenIcon__2sphP"}},5:function(e,a,t){e.exports={header:"header_header__6gxdO",brand:"header_brand__1K8C9","notification-container":"header_notification-container__14rKh","notification-list":"header_notification-list__3s1cr",notification:"header_notification__Uqe7Y",accept:"header_accept__1b30Q",reject:"header_reject__1YyGO",time:"header_time__NGRMa",date:"header_date__2Usv0",account:"header_account__3vXdw","user-image":"header_user-image__3LIcW","account-menu":"header_account-menu__3xaog","account-info":"header_account-info__27gqC",username:"header_username__16FhN",email:"header_email__39044","user-id":"header_user-id__1po7g","sound-container":"header_sound-container__1bze0","menu-items":"header_menu-items__17hUJ","menu-item":"header_menu-item__QHGg9",switch:"header_switch__3HnOO",slider:"header_slider__2REA2"}},52:function(e,a,t){e.exports={"input-field":"input-field_input-field__1CMrc","image-button":"input-field_image-button__2NbVH","emoji-button":"input-field_emoji-button__1bdOL",input:"input-field_input__3nT2d","send-button":"input-field_send-button__38YWd"}}},[[187,1,2]]]);
//# sourceMappingURL=main.1c468b83.chunk.js.map